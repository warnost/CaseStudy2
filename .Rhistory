ggplot(casedata,aes(BusinessTravel)) + geom_bar(aes(y = (..count..)/sum(..count..), fill = Attrition))
ggplot(casedata,aes(BusinessTravel)) + geom_bar(aes(y = (..count..)/sum(..count..), fill = Attrition), position = "dodge")
ggplot(casedata,aes(BusinessTravel)) + geom_bar(aes(y = (..count..)/sum(..count..), fill = Attrition), position = "dodge") + geom_text(aes(label = y), position = position_dodge(0.9))
ggplot(casedata,aes(BusinessTravel)) + geom_bar(aes(y = (..count..)/sum(..count..), fill = Attrition), position = "dodge") + geom_text(aes(label = (..count..)/sum(..count..)), position = position_dodge(0.9))
ggplot(casedata,aes(BusinessTravel)) + geom_bar(aes(y = (..count..)/sum(..count..), fill = Attrition), position = "dodge") + geom_text(aes(label = (..count..)/sum(..count..), position = position_dodge(0.9))
)
ggplot(casedata,aes(BusinessTravel)) + geom_bar(aes(y = (..count..)/sum(..count..), fill = Attrition), position = "dodge") + geom_text(aes(label = (..count..)/sum(..count..)), position = position_dodge(0.9))
ggplot(casedata,aes(BusinessTravel)) + geom_bar(aes(y = (..count..)/sum(..count..), fill = Attrition), position = "dodge") + geom_text(aes(label = (..count..)/sum(..count..)))
ggplot(casedata,aes(BusinessTravel)) + geom_bar(aes(y = (..count..)/sum(..count..), fill = Attrition), position = "dodge")
?aes_string
x11()
library(Amelia)
library(naniar)
missmap(casedata,y.at=c(1),y.labels = c(''))
gg_miss_var(casedata, show_pct=TRUE) + labs(title="Percent Missing by Data Field") +
theme(legend.position = "none",plot.title = element_text(hjust = 0.5),axis.title.y=element_text(angle=0,vjust=1))
library(Amelia)
library(naniar)
missmap(casedata,y.at=c(1),y.labels = c(''))
gg_miss_var(casedata, show_pct=TRUE) + labs(title="Percent Missing by Data Field") +
theme(legend.position = "none",plot.title = element_text(hjust = 0.5),axis.title.y=element_text(angle=0,vjust=1))
parallel::detectCores()
library(caret)
bc <- BreastCancer
install.packages(c("classInt", "deldir", "forecast", "ggplot2", "httr", "installr", "knitr", "lava", "markdown", "modelr", "tinytex", "xml2"))
library(knitr)
library(rmdformats)
## Global options
options(max.print="75")
opts_chunk$set(echo=TRUE,
cache=TRUE,
prompt=FALSE,
tidy=TRUE,
comment=NA,
message=FALSE,
warning=FALSE)
opts_knit$set(width=75)
library(tidyverse)
casedata <-read_csv('CaseStudy2-data.csv')
str(casedata)
table(casedata$Attrition)
casedata %>% group_by(Attrition) %>% summarise( Count = n(), Proportion = n()/dim(casedata)[1])
library(kableExtra)
casedata %>% group_by(Attrition) %>% summarise( Count = n(), Proportion = n()/dim(casedata)[1]) %>% kable()
barPlot <- function(dt, x) {
ggplot(dt, aes_string(x = x)) +
geom_bar()
}
propPlot <- function(dt, x, y) {
ggplot(dt, aes_string(x = x, fill = y)) +
geom_bar(position = "fill") +
scale_y_continuous(labels = scales::percent)
}
fancyTable <- function(dt, x) {
df %>% group_by(x) %>%
summarise( Count = n(), Proportion = n()/dim(df)[1]) %>%
kable() %>% kable_styling(full_width = FALSE)
}
fancyTable(casedata, "Attrition")
casedata  %>% group_by("Attrtion")
casedata  %>% group_by("Attrtion") %>% summarise(Count = n())
casedata  %>% group_by("Attrtion") %>% summarise(Count = n(), Prop = n(dim)[1])
casedata  %>% group_by("Attrtion") %>% summarise(Count = n(), Prop = n()/dim(casedata)[1])
casedata  %>% group_by("Attrition") %>% summarise(Count = n(), Prop = n()/dim(casedata)[1])
barPlot <- function(dt, x) {
ggplot(dt, aes_string(x = x)) +
geom_bar()
}
propPlot <- function(dt, x, y) {
ggplot(dt, aes_string(x = x, fill = y)) +
geom_bar(position = "fill") +
scale_y_continuous(labels = scales::percent)
}
fancyTable <- function(dt, x) {
df %>% group_by_at(x) %>%
summarise( Count = n(), Proportion = n()/dim(df)[1]) %>%
kable() %>% kable_styling(full_width = FALSE)
}
fancyTable(casedata, "Attrition")
casedata  %>% group_by_at("Attrition") %>% summarise(Count = n(), Prop = n()/dim(casedata)[1])
casedata  %>% group_by_at("Attrition") %>% summarise(Count = n(), Prop = n()/dim(casedata)[1]) %>% kable()
casedata  %>% group_by_at("Attrition") %>% summarise(Count = n(), Prop = n()/dim(casedata)[1]) %>% kable() %>% kable_styling(full_width = FALSE)
casedata %>% group_by_at(Attrition) %>%
summarise(Count = n(), Proportion = n()/dim(casedata)[1]) %>%
kable() %>% kable_styling(full_width = FALSE)
casedata  %>% group_by_at("Attrition") %>% summarise(Count = n(), Prop = n()/dim(casedata)[1]) %>% kable() %>% kable_styling(full_width = FALSE)
casedata %>% group_by_at(Attrition) %>%
summarise(Count = n(), Proportion = n()/dim(casedata)[1]) %>%
kable() %>% kable_styling(full_width = FALSE)
casedata %>% group_by_at("Attrition") %>%
summarise(Count = n(), Proportion = n()/dim(casedata)[1]) %>%
kable() %>% kable_styling(full_width = FALSE)
barPlot <- function(dt, x) {
ggplot(dt, aes_string(x = x)) +
geom_bar()
}
propPlot <- function(dt, x, y) {
ggplot(dt, aes_string(x = x, fill = y)) +
geom_bar(position = "fill") +
scale_y_continuous(labels = scales::percent)
}
fancyTable <- function(df, x) {
df %>% group_by_at(x) %>%
summarise(Count = n(), Proportion = n()/dim(df)[1]) %>%
kable() %>% kable_styling(full_width = FALSE)
}
fancyTable(casedata, "Attrition")
barPlot(casedata, "Attrition")
?column_spec
?kableExtra
barPlot <- function(df, x) {
ggplot(df, aes_string(x = x)) +
geom_bar()
}
propPlot <- function(df, x, y) {
ggplot(df, aes_string(x = x, fill = y)) +
geom_bar(position = "fill") +
scale_y_continuous(labels = scales::percent)
}
fancyTable <- function(df, x) {
df %>% group_by_at(x) %>%
summarise(Count = n(), Proportion = n()/dim(df)[1]) %>%
kable() %>% kable_styling(full_width = FALSE)
}
fancyTable(casedata, "BusinessTravel")
barPlot(casedata, "BusinessTravel")
propPlot(casedata, x = "BusinessTravel","Attrition")
fancyTable(casedata, "Department")
barPlot(casedata, "Department")
propPlot(casedata, x = "Department","Attrition")
fancyTable(casedata, "Education")
barPlot(casedata, "Education")
propPlot(casedata, x = "Education","Attrition")
fancyTable(casedata, "EducationField")
barPlot(casedata, "EducationField")
propPlot(casedata, x = "EducationField","Attrition")
fancyTable(casedata, "EnvironmentSatisfaction")
barPlot(casedata, "EnvironmentSatisfaction")
propPlot(casedata, x = "EnvironmentSatisfaction","Attrition")
fancyTable(casedata, "Gendern")
fancyTable(casedata, "Gender")
barPlot(casedata, "Gender")
propPlot(casedata, x = "Gender","Attrition")
fancyTable(casedata, "JobRole")
barPlot(casedata, "JobRole")
propPlot(casedata, x = "JobRole","Attrition")
fancyTable(casedata, "MaritalStatus")
barPlot(casedata, "MaritalStatus")
propPlot(casedata, x = "MaritalStatus","Attrition")
fancyTable(casedata, "Over18 ")
fancyTable(casedata, "Over18")
barPlot(casedata, "Over18")
propPlot(casedata, x = "Over18","Attrition")
fancyTable(casedata, "OverTime")
barPlot(casedata, "OverTime")
propPlot(casedata, x = "OverTime","Attrition")
fancyTable(casedata, "StockOptionLevel")
barPlot(casedata, "StockOptionLevel")
propPlot(casedata, x = "StockOptionLevel","Attrition")
fancyTable(casedata, "JobLevel")
barPlot(casedata, "JobLevel")
propPlot(casedata, x = "JobLevel","Attrition")
fancyTable(casedata, "JobInvolvement")
barPlot(casedata, "JobInvolvement")
propPlot(casedata, x = "JobInvolvement","Attrition")
ggplot(casedata,aes(x = Gender, y = MonthlyIncome)) + geom_violin()
ggplot(casedata,aes(x = Gender, y = MonthlyIncome)) + geom_violin() + geom_boxplot()
ggplot(casedata,aes(x = Gender, y = MonthlyIncome)) + geom_violin() + geom_boxplot(width = 0.25)
ggplot(casedata,aes(x = Gender, y = MonthlyIncome)) + geom_violin() + geom_boxplot(width = 0.20)
ggplot(casedata,aes(x = Gender, y = MonthlyIncome)) + geom_violin() + geom_boxplot(width = 0.20) + theme_void()
ggplot(casedata,aes(x = Gender, y = MonthlyIncome)) + geom_violin() + geom_boxplot(width = 0.20) + theme_classic()
barPlot <- function(df, x) {
ggplot(df, aes_string(x = x)) +
geom_bar()
}
propPlot <- function(df, x, y) {
ggplot(df, aes_string(x = x, fill = y)) +
geom_bar(position = "fill") +
scale_y_continuous(labels = scales::percent)
}
fancyTable <- function(df, x) {
df %>% group_by_at(x) %>%
summarise(Count = n(), Proportion = n()/dim(df)[1]) %>%
kable() %>% kable_styling(full_width = FALSE)
}
vioPlot <- function(df, x, y) {
ggplot(df, aes_string(x = x, y = y, fill = x)) + geom_boxplot(width = 0.20) + stat_summary(fun.y=mean, geom="point", shape=2, size=6, color = "black")
}
ggplot(casedata, aes_string(x = "x"BusinessTravel, y = "MonthlyIncome", fill = "x"BusinessTravel)) + geom_boxplot(width = 0.20) + stat_summary(fun.y=mean, geom="point", shape=2, size=6, color = "black")
ggplot(casedata, aes_string(x = "BusinessTravel", y = "MonthlyIncome", fill = "x"BusinessTravel)) + geom_boxplot(width = 0.20) + stat_summary(fun.y=mean, geom="point", shape=2, size=6, color = "black")
ggplot(casedata, aes_string(x = "BusinessTravel", y = "MonthlyIncome", fill = "BusinessTravel")) + geom_boxplot(width = 0.20) + stat_summary(fun.y=mean, geom="point", shape=2, size=6, color = "black")
ggplot(casedata, aes_string(x = "BusinessTravel", y = "MonthlyIncome", fill = "BusinessTravel")) + geom_boxplot(width = 0.20) + stat_summary(fun.y=mean, geom="point", shape=1, size=6, color = "black")
ggplot(casedata, aes_string(x = "BusinessTravel", y = "MonthlyIncome", fill = "BusinessTravel")) + geom_boxplot(width = 0.20) + stat_summary(fun.y=mean, geom="point", shape=3, size=6, color = "black")
ggplot(casedata, aes_string(x = "BusinessTravel", y = "MonthlyIncome", fill = "BusinessTravel")) + geom_boxplot(width = 0.20) + stat_summary(fun.y=mean, geom="point", shape=4, size=6, color = "black")
5
ggplot(casedata, aes_string(x = "BusinessTravel", y = "MonthlyIncome", fill = "BusinessTravel")) + geom_boxplot(width = 0.20) + stat_summary(fun.y=mean, geom="point", shape=5, size=6, color = "black")
23
ggplot(casedata, aes_string(x = "BusinessTravel", y = "MonthlyIncome", fill = "BusinessTravel")) + geom_boxplot(width = 0.20) + stat_summary(fun.y=mean, geom="point", shape=23, size=6, color = "black")
ggplot(casedata, aes_string(x = "BusinessTravel", y = "MonthlyIncome", fill = "BusinessTravel")) + geom_boxplot(width = 0.20) + stat_summary(fun.y=mean, geom="point", shape=20, size=6, color = "black")
ggplot(casedata, aes_string(x = "BusinessTravel", y = "MonthlyIncome", fill = "BusinessTravel")) + geom_boxplot(width = 0.20) + stat_summary(fun.y=mean, geom="point", shape=5, size=6, color = "black")
ggplot(casedata, aes_string(x = "BusinessTravel", y = "MonthlyIncome", fill = "BusinessTravel")) + geom_boxplot(width = 0.20) + stat_summary(fun.y=mean, geom="point", shape=5, size=4, color = "black")
ggplot(casedata,aes(MonthlyIncome)) + geom_histogram(bins = 30) +
stat_function(fun=dnorm)
library(knitr)
library(rmdformats)
library(kableExtra)
## Global options
options(max.print="75")
opts_chunk$set(echo=TRUE,
cache=FALSE,
prompt=FALSE,
tidy=TRUE,
comment=NA,
message=FALSE,
warning=FALSE)
opts_knit$set(width=75)
library(tidyverse)
casedata <-read_csv('CaseStudy2-data.csv')
str(casedata)
library(Amelia)
library(naniar)
missmap(casedata,y.at=c(1),y.labels = c(''))
gg_miss_var(casedata, show_pct=TRUE) + labs(title="Percent Missing by Data Field") +
theme(legend.position = "none",plot.title = element_text(hjust = 0.5),axis.title.y=element_text(angle=0,vjust=1))
colsToFactor <- c("Attrition","BusinessTravel","Department","EducationField","Gender","JobRole","MaritalStatus","Over18","OverTime","StockOptionLevel","JobLevel","JobInvolvement","Education","EnvironmentSatisfaction")
# Consider "StockOptionLevel","JobLevel","JobInvolvement","Education"; They could be coded as numeric
casedata[,colsToFactor] <- lapply(casedata[,colsToFactor], as.factor)
casedata$logMonthlyIncome <- log(casedata$MonthlyIncome)
barPlot <- function(df, x) {
ggplot(df, aes_string(x = x)) +
geom_bar()
}
propPlot <- function(df, x, y) {
ggplot(df, aes_string(x = x, fill = y)) +
geom_bar(position = "fill") +
scale_y_continuous(labels = scales::percent)
}
fancyTable <- function(df, x) {
df %>% group_by_at(x) %>%
summarise(Count = n(), Proportion = n()/dim(df)[1]) %>%
kable() %>% kable_styling(full_width = FALSE)
}
vioPlot <- function(df, x, y) {
ggplot(df, aes_string(x = x, y = y, fill = x)) + geom_violin() + geom_boxplot(width = 0.20) + stat_summary(fun.y=mean, geom="point", shape=5, size=4, color = "black")
}
fancyTable(casedata, "JobRole")
barPlot(casedata, "JobRole") + theme(axis.text.x = element_text(angle = 90))
propPlot(casedata, x = "JobRole","Attrition") + theme(axis.text.x = element_text(angle = 90))
vioPlot(casedata, x = "JobRole",y="MonthlyIncome") + theme(axis.text.x = element_text(angle = 90))
ggplot(casedata,aes(DailyRate)) + geom_histogram(aes(y=..density..), bins = 30) +
stat_function(fun=dnorm,
color="red",
args=list(mean=mean(casedata$DailyRate),
sd=sd(casedata$DailyRate)))
summary(casedata$DailyRate)
vioPlot(casedata, x = "Attrition",y="DailyRate")
ggplot(casedata,aes(DailyRate)) + geom_histogram(aes(y=..density..), bins = 30) +
stat_function(fun=dnorm,
color="red",
args=list(mean=mean(casedata$DailyRate),
sd=sd(casedata$DailyRate)))
summary(casedata$DailyRate)
#vioPlot(casedata, x = "Attrition",y="DailyRate")
ggplot(casedata, aes(x = DailyRate, y = MonthlyIncome)) + geom_point()
ggplot(casedata,aes(HourlyRate)) + geom_histogram(aes(y=..density..), bins = 30) +
stat_function(fun=dnorm,
color="red",
args=list(mean=mean(casedata$HourlyRate),
sd=sd(casedata$HourlyRate)))
summary(casedata$HourlyRate)
#vioPlot(casedata, x = "Attrition",y="HourlyRate")
ggplot(casedata, aes(x = HourlyRate, y = MonthlyIncome)) + geom_point()
ggplot(casedata,aes(HourlyRate)) + geom_histogram(aes(y=..density..), bins = 30) +
stat_function(fun=dnorm,
color="red",
args=list(mean=mean(casedata$HourlyRate),
sd=sd(casedata$HourlyRate)))
summary(casedata$HourlyRate)
vioPlot(casedata, x = "Attrition",y="HourlyRate")
ggplot(casedata, aes(x = HourlyRate, y = MonthlyIncome)) + geom_point()
ggplot(casedata,aes(DailyRate)) + geom_histogram(aes(y=..density..), bins = 30) +
stat_function(fun=dnorm,
color="red",
args=list(mean=mean(casedata$DailyRate),
sd=sd(casedata$DailyRate)))
summary(casedata$DailyRate)
vioPlot(casedata, x = "Attrition",y="DailyRate")
ggplot(casedata, aes(x = DailyRate, y = MonthlyIncome)) + geom_point()
ggplot(casedata,aes(HourlyRate)) + geom_histogram(aes(y=..density..), bins = 30) +
stat_function(fun=dnorm,
color="red",
args=list(mean=mean(casedata$HourlyRate),
sd=sd(casedata$HourlyRate)))
summary(casedata$HourlyRate)
vioPlot(casedata, x = "Attrition",y="HourlyRate")
ggplot(casedata, aes(x = HourlyRate, y = MonthlyIncome)) + geom_point()
ggplot(casedata, aes(x = HourlyRate, y = DailyRate)) + geom_point()
ggplot(casedata,aes(MonthlyIncome)) + geom_histogram(aes(y=..density..), bins = 30) +
stat_function(fun=dnorm,
color="red",
args=list(mean=mean(casedata$MonthlyIncome),
sd=sd(casedata$MonthlyIncome)))
summary(casedata$MonthlyIncome)
vioPlot(casedata, x = "Attrition",y="MonthlyIncome")
ggplot(casedata,aes(HourlyRate)) + geom_histogram(aes(y=..density..), bins = 30) +
stat_function(fun=dnorm,
color="red",
args=list(mean=mean(casedata$HourlyRate),
sd=sd(casedata$HourlyRate)))
summary(casedata$HourlyRate)
vioPlot(casedata, x = "Attrition",y="HourlyRate")
ggplot(casedata, aes(x = HourlyRate, y = MonthlyIncome)) + geom_point()
ggplot(casedata,aes(DistanceFromHome)) + geom_histogram(aes(y=..density..), bins = 30) +
stat_function(fun=dnorm,
color="red",
args=list(mean=mean(casedata$DistanceFromHome),
sd=sd(casedata$DistanceFromHome)))
summary(casedata$DistanceFromHome)
vioPlot(casedata, x = "Attrition",y="DistanceFromHome")
ggplot(casedata, aes(x = DistanceFromHome, y = MonthlyIncome)) + geom_point()
summary(casedata$EmployeeCount)
summary(casedata$EmployeeNumber)
summary(casedata$ID)
summary(casedata$EmployeeCount)
summary(casedata$EmployeeNumber)
summary(casedata$ID)
n_distinct(casedata$ID)
summary(casedata$EmployeeCount)
summary(casedata$EmployeeNumber)
summary(casedata$ID)
n_distinct(casedata$ID)
n_distinct(casedata$EmployeeNumber)
summary(casedata$EmployeeCount)
n_distinct(casedata$ID)
n_distinct(casedata$EmployeeNumber)
colsToFactor <- c("Attrition","BusinessTravel","Department","EducationField","Gender","JobRole","MaritalStatus","Over18","OverTime","StockOptionLevel","JobLevel","JobInvolvement","Education","EnvironmentSatisfaction","JobSatisfaction","RelationshipSatisfaction","WorkLifeBalance")
# Consider "StockOptionLevel","JobLevel","JobInvolvement","Education"; They could be coded as numeric
casedata[,colsToFactor] <- lapply(casedata[,colsToFactor], as.factor)
casedata$logMonthlyIncome <- log(casedata$MonthlyIncome)
fancyTable(casedata, "RelationshipSatisfaction")
barPlot(casedata, "RelationshipSatisfaction")
propPlot(casedata, x = "RelationshipSatisfaction","Attrition")
vioPlot(casedata, x = "RelationshipSatisfaction",y="MonthlyIncome")
fancyTable(casedata, "JobSatisfaction")
barPlot(casedata, "JobSatisfaction")
propPlot(casedata, x = "JobSatisfaction","Attrition")
vioPlot(casedata, x = "JobSatisfaction",y="MonthlyIncome")
fancyTable(casedata, "WorkLifeBalance")
barPlot(casedata, "WorkLifeBalance")
propPlot(casedata, x = "WorkLifeBalance","Attrition")
vioPlot(casedata, x = "WorkLifeBalance",y="MonthlyIncome")
ggplot(casedata,aes(NumCompaniesWorked)) + geom_histogram(aes(y=..density..), bins = 30) +
stat_function(fun=dnorm,
color="red",
args=list(mean=mean(casedata$NumCompaniesWorked),
sd=sd(casedata$NumCompaniesWorked)))
summary(casedata$NumCompaniesWorked)
vioPlot(casedata, x = "Attrition",y="NumCompaniesWorked")
ggplot(casedata, aes(x = NumCompaniesWorked, y = MonthlyIncome)) + geom_point()
ggplot(casedata,aes(HourlyRate)) + geom_histogram(aes(y=..density..), bins = 30) +
stat_function(fun=dnorm,
color="red",
args=list(mean=mean(casedata$HourlyRate),
sd=sd(casedata$HourlyRate)))
summary(casedata$HourlyRate)
vioPlot(casedata, x = "Attrition",y="HourlyRate")
ggplot(casedata, aes(x = HourlyRate, y = MonthlyIncome)) + geom_point()
ggplot(casedata, aes(x = HourlyRate, y = DailyRate)) + geom_point()
ggplot(casedata, aes(x = HourlyRate, y = MonthlyRate)) + geom_point()
ggplot(casedata,aes(HourlyRate)) + geom_histogram(aes(y=..density..), bins = 30) +
stat_function(fun=dnorm,
color="red",
args=list(mean=mean(casedata$HourlyRate),
sd=sd(casedata$HourlyRate)))
summary(casedata$HourlyRate)
vioPlot(casedata, x = "Attrition",y="HourlyRate")
ggplot(casedata, aes(x = HourlyRate, y = MonthlyIncome)) + geom_point()
ggplot(casedata, aes(x = HourlyRate, y = DailyRate)) + geom_point()
ggplot(casedata, aes(x = HourlyRate, y = MonthlyRate)) + geom_point()
ggplot(casedata, aes(x = MonthlyIncome, y = MonthlyRate)) + geom_point()
ggplot(casedata,aes(PercentSalaryHike)) + geom_histogram(aes(y=..density..), bins = 30) +
stat_function(fun=dnorm,
color="red",
args=list(mean=mean(casedata$PercentSalaryHike),
sd=sd(casedata$PercentSalaryHike)))
summary(casedata$PercentSalaryHike)
vioPlot(casedata, x = "Attrition",y="PercentSalaryHike")
ggplot(casedata, aes(x = PercentSalaryHike, y = MonthlyIncome)) + geom_point()
colsToFactor <- c("Attrition","BusinessTravel","Department","EducationField","Gender","JobRole","MaritalStatus","Over18","OverTime","StockOptionLevel","JobLevel","JobInvolvement","Education","EnvironmentSatisfaction","JobSatisfaction","RelationshipSatisfaction","WorkLifeBalance")
# Consider "StockOptionLevel","JobLevel","JobInvolvement","Education"; They could be coded as numeric
casedata[,colsToFactor] <- lapply(casedata[,colsToFactor], as.factor)
casedata$logMonthlyIncome <- log(casedata$MonthlyIncome)
casedata$Edu4 <- ifelse(casedata$Education == 5, 1, 0)
colsToFactor <- c("Attrition","BusinessTravel","Department","EducationField","Gender","JobRole","MaritalStatus","Over18","OverTime","StockOptionLevel","JobLevel","JobInvolvement","Education","EnvironmentSatisfaction","JobSatisfaction","RelationshipSatisfaction","WorkLifeBalance")
# Consider "StockOptionLevel","JobLevel","JobInvolvement","Education"; They could be coded as numeric
casedata[,colsToFactor] <- lapply(casedata[,colsToFactor], as.factor)
casedata$logMonthlyIncome <- log(casedata$MonthlyIncome)
casedata$Edu4 <- ifelse(casedata$Education == 4, 1, 0)
casedata$Edu5 <- ifelse(casedata$Education == 5, 1, 0)
table(casedata$Education, casedata$Edu4)
table(casedata$Education, casedata$Edu5)
colsToFactor <- c("Attrition","BusinessTravel","Department","EducationField","Gender","JobRole","MaritalStatus","Over18","OverTime","StockOptionLevel","JobLevel","JobInvolvement","Education","EnvironmentSatisfaction","JobSatisfaction","RelationshipSatisfaction","WorkLifeBalance")
# Consider "StockOptionLevel","JobLevel","JobInvolvement","Education"; They could be coded as numeric
casedata[,colsToFactor] <- lapply(casedata[,colsToFactor], as.factor)
casedata$logMonthlyIncome <- log(casedata$MonthlyIncome)
casedata$Edu4 <- ifelse(casedata$Education == 4, 1, 0)
casedata$Edu5 <- ifelse(casedata$Education == 5, 1, 0)
casedata$EnvSat1 <- ifelse(casedata$EnvironmentSatisfaction == 1, 1, 0)
casedata$StockOpt0 <- ifelse(casedata$StockOptionLevel == 0, 1, 0)
casedata$StockOpt3 <- ifelse(casedata$StockOptionLevel == 3, 1, 0)
casedata$StockOpt03 <- ifelse(casedata$StockOptionLevel %in% c(0,3), 1, 0)
casedata$JobLev1 <- ifelse(casedata$JobLevel == 1, 1, 0)
casedata$JobInv1 <- ifelse(casedata$JobInvolvement == 1, 1, 0)
casedata$WorkLife1 <- ifelse(casedata$WorkLifeBalance == 1, 1, 0)
casedata$DistHomeFactor <- as.factor(
case_when(casedata$DistanceFromHome <= 10 ~ "Close",
casedata$DistanceFromHome > 10 & casedata$DistanceFromHome <= 20 ~ "Medium",
casedata$DistanceFromHome > 20 ~ "Far")
)
fancyTable(casedata, "DistHomeFactor")
barPlot(casedata, "DistHomeFactor")
propPlot(casedata, x = "DistHomeFactor","Attrition")
vioPlot(casedata, x = "DistHomeFactor",y="MonthlyIncome")
table(casedata$PerformanceRating)
colsToFactor <- c("Attrition","BusinessTravel","Department","EducationField","Gender","JobRole","MaritalStatus","Over18","OverTime","StockOptionLevel","JobLevel","JobInvolvement","Education","EnvironmentSatisfaction","JobSatisfaction","RelationshipSatisfaction","WorkLifeBalance","PerformanceRating")
# Consider "StockOptionLevel","JobLevel","JobInvolvement","Education"; They could be coded as numeric
casedata[,colsToFactor] <- lapply(casedata[,colsToFactor], as.factor)
casedata$logMonthlyIncome <- log(casedata$MonthlyIncome)
casedata$Edu4 <- ifelse(casedata$Education == 4, 1, 0)
casedata$Edu5 <- ifelse(casedata$Education == 5, 1, 0)
casedata$EnvSat1 <- ifelse(casedata$EnvironmentSatisfaction == 1, 1, 0)
casedata$StockOpt0 <- ifelse(casedata$StockOptionLevel == 0, 1, 0)
casedata$StockOpt3 <- ifelse(casedata$StockOptionLevel == 3, 1, 0)
casedata$StockOpt03 <- ifelse(casedata$StockOptionLevel %in% c(0,3), 1, 0)
casedata$JobLev1 <- ifelse(casedata$JobLevel == 1, 1, 0)
casedata$JobInv1 <- ifelse(casedata$JobInvolvement == 1, 1, 0)
casedata$WorkLife1 <- ifelse(casedata$WorkLifeBalance == 1, 1, 0)
casedata$DistHomeFactor <- as.factor(
case_when(casedata$DistanceFromHome <= 10 ~ "Close",
casedata$DistanceFromHome > 10 & casedata$DistanceFromHome <= 20 ~ "Medium",
casedata$DistanceFromHome > 20 ~ "Far")
)
fancyTable(casedata, "PerformanceRating")
barPlot(casedata, "PerformanceRating")
propPlot(casedata, x = "PerformanceRating","Attrition")
vioPlot(casedata, x = "PerformanceRating",y="MonthlyIncome")
install.packages("GGally")
install.packages("corrplot")
library(knitr)
library(rmdformats)
library(kableExtra)
## Global options
options(max.print="75")
opts_chunk$set(echo=TRUE,
cache=FALSE,
prompt=FALSE,
tidy=TRUE,
comment=NA,
message=FALSE,
warning=FALSE)
opts_knit$set(width=75)
library(tidyverse)
casedata <-read_csv('CaseStudy2-data.csv')
str(casedata)
colsToFactor <- c("Attrition","BusinessTravel","Department","EducationField","Gender","JobRole","MaritalStatus","Over18","OverTime","StockOptionLevel","JobLevel","JobInvolvement","Education","EnvironmentSatisfaction","JobSatisfaction","RelationshipSatisfaction","WorkLifeBalance","PerformanceRating")
# Consider "StockOptionLevel","JobLevel","JobInvolvement","Education"; They could be coded as numeric
casedata[,colsToFactor] <- lapply(casedata[,colsToFactor], as.factor)
casedata$logMonthlyIncome <- log(casedata$MonthlyIncome)
casedata$Edu4 <- ifelse(casedata$Education == 4, 1, 0)
casedata$Edu5 <- ifelse(casedata$Education == 5, 1, 0)
casedata$EnvSat1 <- ifelse(casedata$EnvironmentSatisfaction == 1, 1, 0)
casedata$StockOpt0 <- ifelse(casedata$StockOptionLevel == 0, 1, 0)
casedata$StockOpt3 <- ifelse(casedata$StockOptionLevel == 3, 1, 0)
casedata$StockOpt03 <- ifelse(casedata$StockOptionLevel %in% c(0,3), 1, 0)
casedata$JobLev1 <- ifelse(casedata$JobLevel == 1, 1, 0)
casedata$JobInv1 <- ifelse(casedata$JobInvolvement == 1, 1, 0)
casedata$WorkLife1 <- ifelse(casedata$WorkLifeBalance == 1, 1, 0)
casedata$DistHomeFactor <- as.factor(
case_when(casedata$DistanceFromHome <= 10 ~ "Close",
casedata$DistanceFromHome > 10 & casedata$DistanceFromHome <= 20 ~ "Medium",
casedata$DistanceFromHome > 20 ~ "Far")
)
library(GGally);library(ggplot2)
ggpairs(data = casedata %>% keep(is.numeric()),
)
ggpairs(data = casedata %>% keep(is.numeric),
)
ggpairs(data = casedata,
mapping = aes(color = Attrition),
columns = c("HourlyRate","DailyRate","MonthlyRate","MonthlyIncome"))
colsToFactor <- c("Attrition","BusinessTravel","Department","EducationField","Gender","JobRole","MaritalStatus","Over18","OverTime","StockOptionLevel","JobLevel","JobInvolvement","Education","EnvironmentSatisfaction","JobSatisfaction","RelationshipSatisfaction","WorkLifeBalance","PerformanceRating")
# Consider "StockOptionLevel","JobLevel","JobInvolvement","Education"; They could be coded as numeric
casedata[,colsToFactor] <- lapply(casedata[,colsToFactor], as.factor)
casedata$logMonthlyIncome <- log(casedata$MonthlyIncome)
casedata$Edu4 <- ifelse(casedata$Education == 4, 1, 0)
casedata$Edu5 <- ifelse(casedata$Education == 5, 1, 0)
casedata$EnvSat1 <- ifelse(casedata$EnvironmentSatisfaction == 1, 1, 0)
casedata$StockOpt0 <- ifelse(casedata$StockOptionLevel == 0, 1, 0)
casedata$StockOpt3 <- ifelse(casedata$StockOptionLevel == 3, 1, 0)
casedata$StockOpt03 <- ifelse(casedata$StockOptionLevel %in% c(0,3), 1, 0)
casedata$JobLev1 <- ifelse(casedata$JobLevel == 1, 1, 0)
casedata$JobInv1 <- ifelse(casedata$JobInvolvement == 1, 1, 0)
casedata$WorkLife1 <- ifelse(casedata$WorkLifeBalance == 1, 1, 0)
casedata$DistHomeFactor <- as.factor(
case_when(casedata$DistanceFromHome <= 10 ~ "Close",
casedata$DistanceFromHome > 10 & casedata$DistanceFromHome <= 20 ~ "Medium",
casedata$DistanceFromHome > 20 ~ "Far")
)
casedata$HourDay <- casedata$HourlyRate * 8
ggpairs(data = casedata,
mapping = aes(color = Attrition),
columns = c("HourlyRate","HourDay","DailyRate","MonthlyRate","MonthlyIncome"))
